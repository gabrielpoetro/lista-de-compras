<!doctype html>
<html lang="pt-BR" data-theme="auto">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Lista de Compras Inteligente</title>
    <meta name="color-scheme" content="light dark" />
    <meta name="description" content="App de lista de compras com voz, scanner, categorias e sincroniza√ß√£o." />

    <!-- Tipografia opcional e reset m√≠nimo -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />

    <style>
      :root {
        --bg: #ffffff;
        --fg: #0f172a;
        --muted: #64748b;
        --card: #f8fafc;
        --border: #e2e8f0;
        --brand: #2563eb;
        --brand-fg: #ffffff;
        --danger: #ef4444;
        --ok: #16a34a;
        --warn: #f59e0b;
        --focus: 2px solid #2563eb;
        --radius: 12px;
        --shadow: 0 8px 24px rgba(2, 6, 23, 0.08);
      }
      @media (prefers-color-scheme: dark) {
        [data-theme="auto"] {
          --bg: #0b1220;
          --fg: #e5e7eb;
          --muted: #94a3b8;
          --card: #111827;
          --border: #1f2937;
          --brand: #60a5fa;
          --brand-fg: #0b1220;
          --danger: #f87171;
          --ok: #34d399;
          --warn: #fbbf24;
          --shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
        }
      }
      [data-theme="light"] {
        --bg: #ffffff;
      }
      [data-theme="dark"] {
        --bg: #0b1220;
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
        background: var(--bg);
        color: var(--fg);
        line-height: 1.45;
      }
      .container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
      }
      header.app-header {
        position: sticky; top: 0; z-index: 50;
        backdrop-filter: saturate(180%) blur(10px);
        background: color-mix(in oklab, var(--bg) 70%, transparent);
        border-bottom: 1px solid var(--border);
      }
      .row { display: grid; gap: 12px; }
      @media (min-width: 880px) {
        .row.cols-3 { grid-template-columns: 1.2fr 1fr auto; align-items: end; }
        .row.cols-2 { grid-template-columns: 1fr auto; align-items: center; }
        main.app-main { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; align-items: start; }
      }
      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 16px;
      }
      .title { font-weight: 600; font-size: 1.1rem; margin: 0 0 10px; }
      label { font-size: 0.9rem; color: var(--muted); display: block; margin-bottom: 6px; }
      input, select, button, textarea {
        font: inherit;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--bg);
        color: var(--fg);
        padding: 10px 12px;
      }
      input:focus, select:focus, button:focus, textarea:focus { outline: var(--focus); outline-offset: 2px; }
      .btn {
        border: none;
        cursor: pointer;
        transition: transform .05s ease, filter .2s ease;
      }
      .btn:active { transform: translateY(1px); }
      .btn.primary { background: var(--brand); color: var(--brand-fg); }
      .btn.ghost { background: transparent; border: 1px solid var(--border); }
      .btn.icon { display: inline-flex; align-items: center; gap: 8px; }
      .grid { display: grid; gap: 12px; }
      .grid.cols-4 { grid-template-columns: repeat(2, 1fr); }
      @media (min-width: 680px) { .grid.cols-4 { grid-template-columns: repeat(4, 1fr); } }
      .toolbar { display: flex; gap: 8px; flex-wrap: wrap; }
      .pill {
        display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px;
        border: 1px solid var(--border); border-radius: 999px; background: var(--bg); color: var(--fg);
      }
      .list { display: grid; gap: 8px; margin: 0; padding: 0; list-style: none; }
      .item {
        display: grid; grid-template-columns: auto 1fr auto; gap: 12px; align-items: center;
        padding: 10px; border: 1px solid var(--border); border-radius: 10px; background: var(--bg);
      }
      .item[data-done="true"] .name { text-decoration: line-through; color: var(--muted); }
      .qty { font-variant-numeric: tabular-nums; color: var(--muted); }
      .badge { font-size: 0.75rem; padding: 2px 8px; border-radius: 999px; border: 1px solid var(--border); background: var(--card); color: var(--muted); }
      .muted { color: var(--muted); }
      .spacer { height: 12px; }
      .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

      /* Modal b√°sico */
      .modal-backdrop {
        position: fixed; inset: 0; background: rgba(0,0,0,.5);
        display: none; align-items: center; justify-content: center; padding: 24px;
      }
      .modal-backdrop[aria-hidden="false"] { display: flex; }
      .modal { width: 100%; max-width: 720px; background: var(--card); border: 1px solid var(--border); border-radius: 14px; box-shadow: var(--shadow); }
      .modal header, .modal footer { padding: 16px; border-bottom: 1px solid var(--border); }
      .modal footer { border-top: 1px solid var(--border); border-bottom: none; display: flex; gap: 8px; justify-content: flex-end; }
      .modal .body { padding: 16px; }

      /* Toasts */
      .toasts { position: fixed; right: 16px; bottom: 16px; display: grid; gap: 8px; width: min(360px, calc(100vw - 32px)); }
      .toast { padding: 12px 14px; border-radius: 10px; border: 1px solid var(--border); background: var(--card); box-shadow: var(--shadow); }
      .toast.ok { border-color: color-mix(in oklab, var(--ok) 60%, var(--border)); }
      .toast.warn { border-color: color-mix(in oklab, var(--warn) 60%, var(--border)); }
      .toast.err { border-color: color-mix(in oklab, var(--danger) 60%, var(--border)); }
    </style>
  </head>

  <body>
    <header class="app-header">
      <div class="container">
        <div class="row cols-2">
          <div>
            <h1 style="margin:0; font-size:1.4rem; display:flex; gap:10px; align-items:center;">
              <span aria-hidden="true">üõí</span>
              Lista de Compras
            </h1>
            <p class="muted" style="margin:6px 0 0;">R√°pida, inteligente e compartilh√°vel</p>
          </div>
          <div class="toolbar" style="justify-content:flex-end;">
            <button class="btn ghost icon" id="theme-toggle" aria-pressed="false" title="Alternar tema">
              <span aria-hidden="true">üåì</span>
              <span>Tema</span>
            </button>
            <button class="btn ghost icon" id="auth-btn" data-auth="signed-out">
              <span aria-hidden="true">üîê</span>
              <span id="auth-label">Entrar</span>
            </button>
            <button class="btn primary icon" id="share-btn">
              <span aria-hidden="true">ü§ù</span>
              <span>Compartilhar</span>
            </button>
          </div>
        </div>

        <div class="spacer"></div>

        <div class="row cols-3" role="search">
          <div>
            <label for="search">Buscar itens</label>
            <input id="search" name="search" type="search" placeholder="Ex.: leite, arroz, sab√£o..." autocomplete="off" data-js="search" />
          </div>
          <div>
            <label for="category-filter">Filtrar por categoria</label>
            <select id="category-filter" name="category" data-js="category-filter">
              <option value="">Todas as categorias</option>
              <option value="hortifruti">Hortifruti</option>
              <option value="latic√≠nios">Latic√≠nios</option>
              <option value="a√ßougue">A√ßougue</option>
              <option value="padaria">Padaria</option>
              <option value="limpeza">Limpeza</option>
              <option value="higiene">Higiene</option>
              <option value="bebidas">Bebidas</option>
              <option value="outros">Outros</option>
            </select>
          </div>
          <div class="toolbar" style="justify-content:flex-end;">
            <button class="pill" id="voice-btn">
              <span aria-hidden="true">üéôÔ∏è</span>
              <span>Adicionar por voz</span>
            </button>
            <button class="pill" id="scan-btn">
              <span aria-hidden="true">üì∑</span>
              <span>Escanear c√≥digo</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <main class="app-main" id="main">
        <section aria-labelledby="add-item-title" class="card">
          <h2 class="title" id="add-item-title">Adicionar item</h2>
          <form id="add-form" class="grid cols-4" autocomplete="off" data-js="add-form">
            <div style="grid-column: 1 / -1;">
              <label for="item-name">Nome do item</label>
              <input id="item-name" name="name" type="text" placeholder="Ex.: Leite integral" required data-js="name-input" />
              <div id="suggestions" class="muted" aria-live="polite" data-js="suggestions" style="margin-top:6px;"></div>
            </div>

            <div>
              <label for="item-qty">Quantidade</label>
              <input id="item-qty" name="qty" type="number" min="1" step="1" value="1" data-js="qty-input" />
            </div>

            <div>
              <label for="item-unit">Unidade</label>
              <select id="item-unit" name="unit" data-js="unit-input">
                <option value="un">un</option>
                <option value="kg">kg</option>
                <option value="g">g</option>
                <option value="L">L</option>
                <option value="ml">ml</option>
              </select>
            </div>

            <div>
              <label for="item-category">Categoria</label>
              <select id="item-category" name="category" data-js="category-input">
                <option value="">Escolher...</option>
                <option value="hortifruti">Hortifruti</option>
                <option value="latic√≠nios">Latic√≠nios</option>
                <option value="a√ßougue">A√ßougue</option>
                <option value="padaria">Padaria</option>
                <option value="limpeza">Limpeza</option>
                <option value="higiene">Higiene</option>
                <option value="bebidas">Bebidas</option>
                <option value="outros">Outros</option>
              </select>
            </div>

            <div style="grid-column: 1 / -1; display:flex; gap:10px; align-items:center; justify-content:space-between;">
              <div style="display:flex; gap:16px; align-items:center;">
                <label style="display:flex; gap:8px; align-items:center;">
                  <input type="checkbox" name="recurring" data-js="recurring-input" />
                  <span class="muted">Recorrente</span>
                </label>
                <label style="display:flex; gap:8px; align-items:center;">
                  <input type="checkbox" name="favorite" data-js="favorite-input" />
                  <span class="muted">Favorito</span>
                </label>
              </div>

              <div class="toolbar">
                <button type="button" class="btn ghost" id="clear-form">Limpar</button>
                <button type="submit" class="btn primary icon">
                  <span aria-hidden="true">‚ûï</span>
                  <span>Adicionar</span>
                </button>
              </div>
            </div>
          </form>
        </section>

        <section aria-labelledby="list-title" class="card">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
            <h2 class="title" id="list-title">Sua lista</h2>
            <div class="toolbar">
              <button class="btn ghost" id="mark-all">Marcar tudo</button>
              <button class="btn ghost" id="clear-done">Limpar comprados</button>
              <button class="btn ghost" id="export-btn">Exportar</button>
            </div>
          </div>

          <div class="toolbar" role="toolbar" aria-label="Filtros da lista" style="margin-bottom:8px;">
            <div class="pill" data-js="filter" data-filter="all" aria-pressed="true">Todos</div>
            <div class="pill" data-js="filter" data-filter="pending">Pendentes</div>
            <div class="pill" data-js="filter" data-filter="done">Comprados</div>
            <div class="pill" data-js="filter" data-filter="favorites">Favoritos</div>

            <div style="flex:1"></div>

            <label class="sr-only" for="sort">Ordenar</label>
            <select id="sort" data-js="sort">
              <option value="created_desc">Mais recentes</option>
              <option value="created_asc">Mais antigos</option>
              <option value="name_asc">Nome A‚ÄìZ</option>
              <option value="name_desc">Nome Z‚ÄìA</option>
              <option value="category_asc">Categoria</option>
            </select>
          </div>

          <ul class="list" id="items" aria-live="polite" aria-relevant="additions removals">
            <!-- Itens renderizados via template -->
          </ul>

          <template id="item-template">
            <li class="item" data-id="">
              <button class="btn ghost" data-js="toggle" aria-label="Alternar comprado" title="Marcar como comprado">
                ‚úÖ
              </button>
              <div>
                <div class="name" data-js="name" style="font-weight:600;">Item</div>
                <div class="muted" style="display:flex; gap:8px; align-items:center; margin-top:2px;">
                  <span class="qty" data-js="qty">1 un</span>
                  <span class="badge" data-js="category">Categoria</span>
                  <span class="badge" data-js="flags" hidden>‚òÖ Recorrente</span>
                </div>
              </div>
              <div class="toolbar">
                <button class="btn ghost" data-js="decrement" title="Diminuir">‚ûñ</button>
                <button class="btn ghost" data-js="increment" title="Aumentar">‚ûï</button>
                <button class="btn ghost" data-js="edit" title="Editar">‚úèÔ∏è</button>
                <button class="btn ghost" data-js="delete" title="Remover">üóëÔ∏è</button>
              </div>
            </li>
          </template>
        </section>

        <aside aria-labelledby="insights-title" class="card">
          <h2 class="title" id="insights-title">Resumo</h2>
          <div class="grid">
            <div class="card" style="padding:12px;">
              <div class="muted">Total de itens</div>
              <div style="font-size:1.4rem; font-weight:600;" data-js="stat-total">0</div>
            </div>
            <div class="card" style="padding:12px;">
              <div class="muted">Pendentes</div>
              <div style="font-size:1.4rem; font-weight:600;" data-js="stat-pending">0</div>
            </div>
            <div class="card" style="padding:12px;">
              <div class="muted">Comprados</div>
              <div style="font-size:1.4rem; font-weight:600;" data-js="stat-done">0</div>
            </div>
            <div class="card" style="padding:12px;">
              <div class="muted">Categorias</div>
              <div style="font-size:1.4rem; font-weight:600;" data-js="stat-cats">0</div>
            </div>
          </div>

          <div class="spacer"></div>

          <h3 class="title" style="font-size:1rem;">Colaboradores</h3>
          <div id="members" class="toolbar" aria-live="polite">
            <span class="muted">Sem colaboradores ainda</span>
          </div>
        </aside>
      </main>
    </div>

    <!-- Modal de scanner -->
    <div class="modal-backdrop" id="scanner-backdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="scanner-title" aria-describedby="scanner-desc">
        <header>
          <h2 id="scanner-title" style="margin:0;">Escanear c√≥digo de barras</h2>
          <p id="scanner-desc" class="muted" style="margin:6px 0 0;">Aponte a c√¢mera para o c√≥digo. Ilumina√ß√£o ajuda.</p>
        </header>
        <div class="body">
          <div class="card" style="height:320px; display:grid; place-items:center;">
            <video id="scanner-video" playsinline style="width:100%; height:100%; background:black; border-radius:10px;"></video>
          </div>
          <p class="muted" id="scanner-status" style="margin-top:8px;">Iniciando c√¢mera‚Ä¶</p>
        </div>
        <footer>
          <button class="btn ghost" id="scanner-cancel">Cancelar</button>
          <button class="btn primary" id="scanner-confirm" disabled>Usar resultado</button>
        </footer>
      </div>
    </div>

    <!-- √Årea de toasts -->
    <div class="toasts" aria-live="polite" aria-relevant="additions" id="toasts"></div>

    <!-- Script de inicializa√ß√£o m√≠nimo para o tema (opcional) -->
    <script>
      (function () {
        const root = document.documentElement;
        const btn = document.getElementById('theme-toggle');
        const key = 'app.theme';
        const load = () => localStorage.getItem(key) || 'auto';
        const save = (v) => localStorage.setItem(key, v);
        const set = (v) => root.setAttribute('data-theme', v);
        let current = load(); set(current);

        btn?.addEventListener('click', () => {
          current = current === 'light' ? 'dark' : current === 'dark' ? 'auto' : 'light';
          set(current); save(current);
          btn.setAttribute('aria-pressed', String(current !== 'auto'));
        });
      })();
    </script>

    <!-- Ponto para seu app.js -->
    <!-- <script src="./app.js" type="module"></script> -->
  </body>
</html>
